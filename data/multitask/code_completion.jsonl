{"id": "df742037-df4b-4747-9467-fa00fe23605a", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"age": "int64", "name": "string"}}}}, "input": {"partial_code": "table.filter(table.age >"}, "target": {"completed_code": "table.filter(table.age > 18)", "explanation": "Complete numeric comparison filter"}, "meta": {"template": "filter_completion", "variation": "simple_numeric_filter", "difficulty": "easy", "features": ["filter", "completion", "predicates"]}}
{"id": "0d80303a-b2b3-48c7-905d-80c4fd6ebfd9", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"is_active": "boolean", "age": "int64"}}}}, "input": {"partial_code": "table.filter(table.is_active &"}, "target": {"completed_code": "table.filter(table.is_active & (table.age > 21))", "explanation": "Complete compound boolean filter"}, "meta": {"template": "filter_completion", "variation": "boolean_filter", "difficulty": "easy", "features": ["filter", "completion", "predicates"]}}
{"id": "ce8d6072-e499-41e8-96f6-9e718c9153ab", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"name": "string", "email": "string"}}}}, "input": {"partial_code": "table.filter(table.name.like("}, "target": {"completed_code": "table.filter(table.name.like('%John%'))", "explanation": "Complete string pattern matching"}, "meta": {"template": "filter_completion", "variation": "string_filter", "difficulty": "easy", "features": ["filter", "completion", "predicates"]}}
{"id": "81677a66-1217-473e-85c6-45e42978b415", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"user_id": "int64", "amount": "float64", "timestamp": "timestamp"}}}}, "input": {"partial_code": "table.filter(table.amount > 100).select("}, "target": {"completed_code": "table.filter(table.amount > 100).select('user_id', 'amount')", "explanation": "Complete column selection after filter"}, "meta": {"template": "filter_completion", "variation": "select_after_filter", "difficulty": "easy", "features": ["filter", "completion", "predicates"]}}
{"id": "34a447f4-e0d8-49d2-86e4-6c5dd8e2be09", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"category": "string", "region": "string", "amount": "float64"}}}}, "input": {"partial_code": "table.filter(table.category == 'sales').group_by("}, "target": {"completed_code": "table.filter(table.category == 'sales').group_by('region').agg(total=table.amount.sum())", "explanation": "Complete aggregation after filter"}, "meta": {"template": "filter_completion", "variation": "groupby_after_filter", "difficulty": "easy", "features": ["filter", "completion", "predicates"]}}
{"id": "87a3e21c-d5ea-47f8-94b9-84bf1657af0e", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"created_at": "timestamp", "user_id": "int64"}}}}, "input": {"partial_code": "table.filter(table.created_at >"}, "target": {"completed_code": "table.filter(table.created_at > '2024-01-01')", "explanation": "Complete temporal comparison"}, "meta": {"template": "filter_completion", "variation": "temporal_filter", "difficulty": "easy", "features": ["filter", "completion", "predicates"]}}
{"id": "bdd9b84f-3cf9-4645-8a1a-74a0fba2313d", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"email": "string", "phone": "string"}}}}, "input": {"partial_code": "table.filter(table.email.notnull("}, "target": {"completed_code": "table.filter(table.email.notnull())", "explanation": "Complete null checking method"}, "meta": {"template": "filter_completion", "variation": "null_check", "difficulty": "easy", "features": ["filter", "completion", "predicates"]}}
{"id": "7231016d-da46-4372-960d-da957d740530", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"status": "string", "user_id": "int64"}}}}, "input": {"partial_code": "table.filter(table.status.isin(["}, "target": {"completed_code": "table.filter(table.status.isin(['active', 'pending']))", "explanation": "Complete membership test"}, "meta": {"template": "filter_completion", "variation": "isin_filter", "difficulty": "easy", "features": ["filter", "completion", "predicates"]}}
{"id": "f250c531-280e-44bd-a606-30d4790c6ef0", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"category": "string", "amount": "float64", "quantity": "int64"}}}}, "input": {"partial_code": "table.group_by('category').agg("}, "target": {"completed_code": "table.group_by('category').agg(total=table.amount.sum())"}, "meta": {"template": "aggregation_completion", "variation": "simple_groupby", "difficulty": "medium", "features": ["aggregation", "group_by", "completion"]}}
{"id": "4151023c-715b-4b9b-b9d3-920fca6c6699", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"region": "string", "sales": "float64", "price": "float64"}}}}, "input": {"partial_code": "table.group_by('region').agg(total_sales=table.sales.sum(), avg_price="}, "target": {"completed_code": "table.group_by('region').agg(total_sales=table.sales.sum(), avg_price=table.price.mean())"}, "meta": {"template": "aggregation_completion", "variation": "multiple_aggregations", "difficulty": "medium", "features": ["aggregation", "group_by", "completion"]}}
{"id": "d61597fb-d0aa-4407-a24a-3147a39a0b73", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"user_id": "int64", "event_type": "string"}}}}, "input": {"partial_code": "table.group_by('user_id').agg(event_count="}, "target": {"completed_code": "table.group_by('user_id').agg(event_count=table.count())"}, "meta": {"template": "aggregation_completion", "variation": "count_aggregation", "difficulty": "medium", "features": ["aggregation", "group_by", "completion"]}}
{"id": "68cade30-49f7-4bff-9827-4a8bfbe9e145", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"region": "string", "category": "string", "amount": "float64"}}}}, "input": {"partial_code": "table.group_by(['region', 'category']).agg("}, "target": {"completed_code": "table.group_by(['region', 'category']).agg(total=table.amount.sum())"}, "meta": {"template": "aggregation_completion", "variation": "multiple_groupby_keys", "difficulty": "medium", "features": ["aggregation", "group_by", "completion"]}}
{"id": "93a3a24a-50a0-4b30-b6cd-53d3dcd67574", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"category": "string", "amount": "float64"}}}}, "input": {"partial_code": "table.group_by('category').agg(high_value_count=(table.amount > 100).sum("}, "target": {"completed_code": "table.group_by('category').agg(high_value_count=(table.amount > 100).sum())"}, "meta": {"template": "aggregation_completion", "variation": "conditional_aggregation", "difficulty": "medium", "features": ["aggregation", "group_by", "completion"]}}
{"id": "aa70d9a9-230f-4b7b-b02f-e838cce57a76", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"orders": {"schema": {"order_id": "int64", "customer_id": "int64", "amount": "float64"}}, "customers": {"schema": {"customer_id": "int64", "name": "string"}}}}, "input": {"partial_code": "orders.join(customers, orders.customer_id =="}, "target": {"completed_code": "orders.join(customers, orders.customer_id == customers.customer_id)"}, "meta": {"template": "join_completion", "variation": "inner_join_simple", "difficulty": "medium", "features": ["join", "completion"]}}
{"id": "d11f15a6-9ed1-4fe3-afe4-0199ae4540f3", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"users": {"schema": {"user_id": "int64", "email": "string"}}, "profiles": {"schema": {"user_id": "int64", "bio": "string"}}}}, "input": {"partial_code": "users.left_join(profiles,"}, "target": {"completed_code": "users.left_join(profiles, users.user_id == profiles.user_id)"}, "meta": {"template": "join_completion", "variation": "left_join", "difficulty": "medium", "features": ["join", "completion"]}}
{"id": "e775f16c-b14f-40f2-beb0-d3c6a4f22084", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"sales_a": {"schema": {"region": "string", "quarter": "int64", "amount": "float64"}}, "sales_b": {"schema": {"region": "string", "quarter": "int64", "units": "int64"}}}}, "input": {"partial_code": "sales_a.join(sales_b, (sales_a.region == sales_b.region) &"}, "target": {"completed_code": "sales_a.join(sales_b, (sales_a.region == sales_b.region) & (sales_a.quarter == sales_b.quarter))"}, "meta": {"template": "join_completion", "variation": "join_multiple_conditions", "difficulty": "medium", "features": ["join", "completion"]}}
{"id": "883998ec-6a6b-4dca-ab6f-935025c74369", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"actual": {"schema": {"region": "string", "sales": "float64"}}, "targets": {"schema": {"region": "string", "target": "float64"}}}}, "input": {"partial_code": "actual.outer_join(targets,"}, "target": {"completed_code": "actual.outer_join(targets, actual.region == targets.region)"}, "meta": {"template": "join_completion", "variation": "outer_join", "difficulty": "medium", "features": ["join", "completion"]}}
{"id": "ee97eb32-278c-4efc-b292-698843de3830", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"customers": {"schema": {"customer_id": "int64", "name": "string"}}, "orders": {"schema": {"customer_id": "int64", "order_id": "int64"}}}}, "input": {"partial_code": "customers.anti_join(orders,"}, "target": {"completed_code": "customers.anti_join(orders, customers.customer_id == orders.customer_id)"}, "meta": {"template": "join_completion", "variation": "anti_join", "difficulty": "medium", "features": ["join", "completion"]}}
{"id": "d8044bd0-cacf-465e-a9bd-7d2fe9d75585", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"products": {"schema": {"product_id": "int64", "name": "string"}}, "recent_orders": {"schema": {"product_id": "int64", "order_date": "timestamp"}}}}, "input": {"partial_code": "products.semi_join(recent_orders,"}, "target": {"completed_code": "products.semi_join(recent_orders, products.product_id == recent_orders.product_id)"}, "meta": {"template": "join_completion", "variation": "semi_join", "difficulty": "medium", "features": ["join", "completion"]}}
{"id": "5c856b0e-a1be-490b-81c4-caaeffc46a80", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"orders": {"schema": {"order_id": "int64", "customer_id": "int64", "product_id": "int64"}}, "customers": {"schema": {"customer_id": "int64", "name": "string"}}, "products": {"schema": {"product_id": "int64", "name": "string"}}}}, "input": {"partial_code": "orders.join(customers, orders.customer_id == customers.customer_id).join(products,"}, "target": {"completed_code": "orders.join(customers, orders.customer_id == customers.customer_id).join(products, orders.product_id == products.product_id)"}, "meta": {"template": "join_completion", "variation": "chained_joins", "difficulty": "medium", "features": ["join", "completion"]}}
{"id": "ea983351-e7f7-4c1d-aa27-a74524b55888", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"orders": {"schema": {"customer_id": "int64", "amount": "float64"}}, "customers": {"schema": {"customer_id": "int64", "name": "string"}}}}, "input": {"partial_code": "orders.filter(orders.amount > 100).join(customers,"}, "target": {"completed_code": "orders.filter(orders.amount > 100).join(customers, orders.customer_id == customers.customer_id)"}, "meta": {"template": "join_completion", "variation": "join_with_filter", "difficulty": "medium", "features": ["join", "completion"]}}
{"id": "7815c3f4-7c2e-46f6-9880-8f0765b48dca", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"orders": {"schema": {"order_id": "int64", "customer_id": "int64", "amount": "float64"}}, "customers": {"schema": {"customer_id": "int64", "name": "string"}}}}, "input": {"partial_code": "orders.join(customers, orders.customer_id == customers.customer_id).select('order_id', 'name',"}, "target": {"completed_code": "orders.join(customers, orders.customer_id == customers.customer_id).select('order_id', 'name', 'amount')"}, "meta": {"template": "join_completion", "variation": "join_with_select", "difficulty": "medium", "features": ["join", "completion"]}}
{"id": "a851e6fc-123e-4343-9f19-1aa735725793", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"employees": {"schema": {"employee_id": "int64", "manager_id": "int64", "name": "string"}}}}, "input": {"partial_code": "employees.join(employees.relabel({'employee_id': 'manager_id', 'name': 'manager_name'}),"}, "target": {"completed_code": "employees.join(employees.relabel({'employee_id': 'manager_id', 'name': 'manager_name'}), employees.manager_id == employees.manager_id)"}, "meta": {"template": "join_completion", "variation": "self_join", "difficulty": "medium", "features": ["join", "completion"]}}
{"id": "a141c231-991d-44c3-a031-bb04964bc420", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"customers": {"schema": {"customer_id": "int64", "name": "string"}}, "orders": {"schema": {"customer_id": "int64", "amount": "float64"}}}}, "input": {"partial_code": "customers.join(orders.group_by('customer_id').agg(total=orders.amount.sum()),"}, "target": {"completed_code": "customers.join(orders.group_by('customer_id').agg(total=orders.amount.sum()), customers.customer_id == orders.customer_id)"}, "meta": {"template": "join_completion", "variation": "join_with_aggregation", "difficulty": "medium", "features": ["join", "completion"]}}
{"id": "0d35145a-5160-4853-856c-f8c21bc9fa64", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"trades": {"schema": {"timestamp": "timestamp", "symbol": "string", "price": "float64"}}, "quotes": {"schema": {"timestamp": "timestamp", "symbol": "string", "bid": "float64"}}}}, "input": {"partial_code": "trades.asof_join(quotes, 'timestamp',"}, "target": {"completed_code": "trades.asof_join(quotes, 'timestamp', predicates=trades.symbol == quotes.symbol)"}, "meta": {"template": "join_completion", "variation": "asof_join", "difficulty": "medium", "features": ["join", "completion"]}}
{"id": "6044299c-dd51-46cb-aac6-8f651406b5eb", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"category": "string", "sales": "float64"}}}}, "input": {"partial_code": "window = ibis.window(group_by='category', order_by='sales')\ntable.mutate(rank="}, "target": {"completed_code": "window = ibis.window(group_by='category', order_by='sales')\ntable.mutate(rank=ibis.row_number().over(window))"}, "meta": {"template": "window_completion", "variation": "row_number_basic", "difficulty": "hard", "features": ["window", "completion", "analytics"]}}
{"id": "d09eeedc-74ec-4ea1-a537-5cb2629a5780", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"date": "timestamp", "amount": "float64"}}}}, "input": {"partial_code": "window = ibis.window(order_by='date', rows=(None, 0))\ntable.mutate(running_total="}, "target": {"completed_code": "window = ibis.window(order_by='date', rows=(None, 0))\ntable.mutate(running_total=table.amount.sum().over(window))"}, "meta": {"template": "window_completion", "variation": "running_total", "difficulty": "hard", "features": ["window", "completion", "analytics"]}}
{"id": "3a3b1b28-d7d6-47ef-b3e2-925ee614ff8b", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"date": "timestamp", "value": "float64"}}}}, "input": {"partial_code": "window = ibis.window(order_by='date', rows=(6, 0))\ntable.mutate(ma_7="}, "target": {"completed_code": "window = ibis.window(order_by='date', rows=(6, 0))\ntable.mutate(ma_7=table.value.mean().over(window))"}, "meta": {"template": "window_completion", "variation": "moving_average", "difficulty": "hard", "features": ["window", "completion", "analytics"]}}
{"id": "dc593ac7-f6f1-4aaf-a364-81ca60ea1fd2", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"date": "timestamp", "value": "float64"}}}}, "input": {"partial_code": "window = ibis.window(order_by='date')\ntable.mutate(previous_value="}, "target": {"completed_code": "window = ibis.window(order_by='date')\ntable.mutate(previous_value=table.value.lag().over(window))"}, "meta": {"template": "window_completion", "variation": "lag_function", "difficulty": "hard", "features": ["window", "completion", "analytics"]}}
{"id": "6800c5d8-7e7d-4c01-9763-f9e0c6f3ddac", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"date": "timestamp", "value": "float64"}}}}, "input": {"partial_code": "window = ibis.window(order_by='date')\ntable.mutate(next_value="}, "target": {"completed_code": "window = ibis.window(order_by='date')\ntable.mutate(next_value=table.value.lead().over(window))"}, "meta": {"template": "window_completion", "variation": "lead_function", "difficulty": "hard", "features": ["window", "completion", "analytics"]}}
{"id": "fff6c342-4f3a-4397-a85e-1a244754f27e", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"region": "string", "sales": "float64"}}}}, "input": {"partial_code": "window = ibis.window(group_by='region', order_by=ibis.desc('sales'))\ntable.mutate(rank="}, "target": {"completed_code": "window = ibis.window(group_by='region', order_by=ibis.desc('sales'))\ntable.mutate(rank=ibis.rank().over(window))"}, "meta": {"template": "window_completion", "variation": "rank_function", "difficulty": "hard", "features": ["window", "completion", "analytics"]}}
{"id": "fc491b64-fcde-42c9-abe9-f99601f9ac58", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"score": "float64"}}}}, "input": {"partial_code": "window = ibis.window(order_by=ibis.desc('score'))\ntable.mutate(rank="}, "target": {"completed_code": "window = ibis.window(order_by=ibis.desc('score'))\ntable.mutate(rank=ibis.dense_rank().over(window))"}, "meta": {"template": "window_completion", "variation": "dense_rank", "difficulty": "hard", "features": ["window", "completion", "analytics"]}}
{"id": "787d7f6f-4050-461f-97db-fcfc619e9daf", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"test_score": "float64"}}}}, "input": {"partial_code": "window = ibis.window(order_by='test_score')\ntable.mutate(percentile="}, "target": {"completed_code": "window = ibis.window(order_by='test_score')\ntable.mutate(percentile=ibis.percent_rank().over(window) * 100)"}, "meta": {"template": "window_completion", "variation": "percent_rank", "difficulty": "hard", "features": ["window", "completion", "analytics"]}}
{"id": "64e2507d-a03d-41f7-8c4f-aaee931a0899", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"value": "float64"}}}}, "input": {"partial_code": "window = ibis.window(order_by='value')\ntable.mutate(quartile="}, "target": {"completed_code": "window = ibis.window(order_by='value')\ntable.mutate(quartile=ibis.ntile(4).over(window))"}, "meta": {"template": "window_completion", "variation": "ntile_quartiles", "difficulty": "hard", "features": ["window", "completion", "analytics"]}}
{"id": "c00d5536-1546-4408-9ea3-523db494c7ff", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"group": "string", "date": "timestamp", "value": "float64"}}}}, "input": {"partial_code": "window = ibis.window(group_by='group', order_by='date')\ntable.mutate(first_value="}, "target": {"completed_code": "window = ibis.window(group_by='group', order_by='date')\ntable.mutate(first_value=table.value.first().over(window))"}, "meta": {"template": "window_completion", "variation": "first_value", "difficulty": "hard", "features": ["window", "completion", "analytics"]}}
{"id": "2d35c3da-ab28-486d-8c4c-a9d3484a8370", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"group": "string", "date": "timestamp", "value": "float64"}}}}, "input": {"partial_code": "window = ibis.window(group_by='group', order_by='date')\ntable.mutate(last_value="}, "target": {"completed_code": "window = ibis.window(group_by='group', order_by='date')\ntable.mutate(last_value=table.value.last().over(window))"}, "meta": {"template": "window_completion", "variation": "last_value", "difficulty": "hard", "features": ["window", "completion", "analytics"]}}
{"id": "19e0099c-9aa5-438a-bdcf-c540c312d9ba", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"customer_id": "int64", "purchase_date": "timestamp", "amount": "float64"}}}}, "input": {"partial_code": "window = ibis.window(group_by='customer_id', order_by='purchase_date', rows=(None, 0))\ntable.mutate(lifetime_value="}, "target": {"completed_code": "window = ibis.window(group_by='customer_id', order_by='purchase_date', rows=(None, 0))\ntable.mutate(lifetime_value=table.amount.sum().over(window))"}, "meta": {"template": "window_completion", "variation": "cumulative_sum", "difficulty": "hard", "features": ["window", "completion", "analytics"]}}
{"id": "60b41ec5-3730-4c30-a5eb-70146cc8475b", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"category": "string", "sales": "float64"}}}}, "input": {"partial_code": "window = ibis.window(group_by='category')\ntable.mutate(category_total="}, "target": {"completed_code": "window = ibis.window(group_by='category')\ntable.mutate(category_total=table.sales.sum().over(window))"}, "meta": {"template": "window_completion", "variation": "window_aggregation_sum", "difficulty": "hard", "features": ["window", "completion", "analytics"]}}
{"id": "d336020d-5176-4795-93aa-2c2e0394e236", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"region": "string"}}}}, "input": {"partial_code": "window = ibis.window(group_by='region')\ntable.mutate(region_count="}, "target": {"completed_code": "window = ibis.window(group_by='region')\ntable.mutate(region_count=ibis.count().over(window))"}, "meta": {"template": "window_completion", "variation": "window_aggregation_count", "difficulty": "hard", "features": ["window", "completion", "analytics"]}}
{"id": "3f72fd52-3597-48b7-b925-51831b3ffa30", "task": "code_completion", "system_prompt": "You are an expert in Ibis, a Python library for data manipulation.\nComplete the partial Ibis expression provided by the user.\nOutput only the completed code, no explanations.", "context": {"tables": {"table": {"schema": {"product_id": "int64", "year": "int64", "sales": "float64"}}}}, "input": {"partial_code": "window = ibis.window(group_by='product_id', order_by='year')\ntable.mutate(previous_year_sales="}, "target": {"completed_code": "window = ibis.window(group_by='product_id', order_by='year')\ntable.mutate(previous_year_sales=table.sales.lag().over(window))"}, "meta": {"template": "window_completion", "variation": "year_over_year_comparison", "difficulty": "hard", "features": ["window", "completion", "analytics"]}}
